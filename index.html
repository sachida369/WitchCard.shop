<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Destiny Scratch Cards</title>
  <style>
    body { font-family: Poppins, sans-serif; background: linear-gradient(135deg, #2b1055, #7597de); text-align:center; color:white; }
    .globe { width:200px; height:200px; margin:20px auto; border-radius:50%; background: radial-gradient(circle, #fff, #87CEEB, #000); animation: glow 4s infinite; }
    @keyframes glow { 0%{box-shadow:0 0 10px #fff;} 50%{box-shadow:0 0 40px #87CEEB;} 100%{box-shadow:0 0 10px #fff;} }
    .card { width:200px; background:#222; border-radius:15px; margin:15px; display:inline-block; cursor:pointer; }
    .foil { background:silver; width:100%; height:150px; border-radius:10px; position:relative; }
    #scratchCanvas { position:absolute; left:0; top:0; border-radius:10px; }
    button { margin:10px; padding:10px 20px; background:gold; border:none; border-radius:10px; cursor:pointer; font-size:16px; }
    input { margin:5px; padding:10px; border-radius:8px; border:none; width:80%; }
  </style>
</head>
<body>
  <h1>ðŸ”® Destiny Scratch Cards</h1>
  <div class="globe"></div>
  <p>Enter your details & unlock your destiny</p>
  
  <input type="text" id="name" placeholder="Full Name"><br>
  <input type="date" id="dob"><br>
  <input type="text" id="place" placeholder="Birth Place"><br>
  <input type="time" id="time"><br>
  
  <button onclick="payNow()">Pay â‚¹10 to Scratch</button>
  
  <div class="card" id="scratchCard" style="display:none; position:relative;">
    <div class="foil" id="foil">
      <canvas id="scratchCanvas" width="200" height="150"></canvas>
      <div id="scratchText" style="position:absolute;top:55px;width:100%;text-align:center;color:gold;font-size:18px;z-index:0;">
      </div>
    </div>
  </div>
  
  <div id="result"></div>

  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    let destinyOptions = [
      "Priya", "Neha", "Simran", "Shruti", "Riya", "Aarohi", "Kavya", "Ishita", "Sakshi",
      "You will be a CEO!", "You will travel to Paris!", "Your lucky number is 7!"
    ];
    let destinyResult = "";

    function payNow(){
      var options = {
        "key": "rzp_live_Hd6RirzluzFacK", // âœ… Tumhara live key id
        "amount": 1000, // 10 INR (paise me)
        "currency": "INR",
        "name": "Destiny Scratch Cards",
        "description": "Unlock your destiny card",
        "handler": function (response){
          alert("Payment Successful! Payment ID: " + response.razorpay_payment_id);
          showScratchCard();
        },
        "prefill": {
          "name": document.getElementById("name").value,
          "email": "customer@example.com",
          "contact": "9999999999"
        },
        "theme": { "color": "#F4C542" }
      };
      var rzp1 = new Razorpay(options);
      rzp1.open();
    }

    function showScratchCard() {
      destinyResult = destinyOptions[Math.floor(Math.random()*destinyOptions.length)];
      document.getElementById('scratchCard').style.display = 'inline-block';
      document.getElementById('scratchText').innerHTML = "âœ¨ " + destinyResult + " âœ¨";
      setupScratch();
    }

    function setupScratch() {
      const canvas = document.getElementById('scratchCanvas');
      const ctx = canvas.getContext('2d');
      ctx.globalCompositeOperation = 'source-over';
      ctx.fillStyle = 'silver';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.globalCompositeOperation = 'destination-out';
      let isDrawing = false;

      canvas.onmousedown = function(e) { isDrawing = true; scratch(e); };
      canvas.onmouseup = function() { isDrawing = false; };
      canvas.onmouseleave = function() { isDrawing = false; };
      canvas.onmousemove = function(e) { if (isDrawing) scratch(e); };

      canvas.ontouchstart = function(e) { isDrawing = true; scratch(e.touches[0]); e.preventDefault(); };
      canvas.ontouchend = function() { isDrawing = false; };
      canvas.ontouchcancel = function() { isDrawing = false; };
      canvas.ontouchmove = function(e) { if (isDrawing) scratch(e.touches[0]); e.preventDefault(); };

      function scratch(e) {
        const rect = canvas.getBoundingClientRect();
        let x = e.clientX - rect.left;
        let y = e.clientY - rect.top;
        ctx.beginPath();
        ctx.arc(x, y, 18, 0, Math.PI * 2, false);
        ctx.fill();
        revealIfScratchedEnough();
      }

      function revealIfScratchedEnough() {
        let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        let pixels = imageData.data;
        let transparent = 0;
        for(let i=3; i<pixels.length; i+=4) if(pixels[i] < 128) transparent++;
        let percent = transparent / (canvas.width * canvas.height) * 100;
        if(percent > 50) {
          canvas.style.display = 'none';
        }
      }
    }
  </script>
</body>
</html>
